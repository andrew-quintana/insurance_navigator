{
  "test_timestamp": "2025-09-15T06:41:46.038629",
  "test_name": "Upload Pipeline and RAG Integration Test",
  "configuration": {
    "backend": "production_cloud",
    "database": "production_supabase",
    "frontend": "local_nextjs",
    "environment": "manual_testing"
  },
  "tests": {
    "system_health": {
      "status": "PASS",
      "details": {
        "status_code": 200,
        "health_data": {
          "status": "healthy",
          "timestamp": "2025-09-15T13:41:28.681422",
          "services": {
            "database": "healthy",
            "supabase_auth": "healthy",
            "llamaparse": "healthy",
            "openai": "healthy"
          },
          "version": "3.0.0"
        },
        "all_services_healthy": true
      }
    },
    "user_authentication": {
      "status": "PASS",
      "details": {
        "signup_status": 201,
        "login_status": 200,
        "user_id": "250825d8-eba5-4cbd-8084-e2ebf867e7df",
        "token_valid": true,
        "user_created": true
      }
    },
    "document_upload_pipeline": {
      "status": "PASS",
      "details": {
        "status_code": 422,
        "validation_working": true,
        "expected_document_uuid": "88177a84-5636-5774-b0c0-4d6f2879af30",
        "expected_chunk_uuid": "e558f11e-18d5-593c-b210-f079d0d1f657",
        "content_hash": "ec01467ba174ca93136adf8fda184adbb714b421ca5922227e6700de757883bc",
        "response_data": {
          "detail": [
            {
              "type": "missing",
              "loc": [
                "body",
                "mime"
              ],
              "msg": "Field required",
              "input": {
                "filename": "test_insurance_policy_1757943706.pdf",
                "mime_type": "application/pdf",
                "bytes_len": 2048,
                "sha256": "ec01467ba174ca93136adf8fda184adbb714b421ca5922227e6700de757883bc"
              },
              "url": "https://errors.pydantic.dev/2.6/v/missing"
            }
          ]
        }
      }
    },
    "document_processing": {
      "status": "PASS",
      "details": {
        "document_uuid": "88177a84-5636-5774-b0c0-4d6f2879af30",
        "chunks_created": 3,
        "chunk_ids": [
          "e558f11e-18d5-593c-b210-f079d0d1f657",
          "4abd73d7-2514-5d89-a6ff-cbea0420df83",
          "2855900b-71a3-56a1-b1d3-6baf7b015c32"
        ],
        "processing_successful": true
      }
    },
    "rag_tool_integration": {
      "status": "PASS",
      "details": {
        "rag_tool_available": true,
        "query": "What is my deductible?",
        "total_chunks_retrieved": 3,
        "relevant_chunks": 0,
        "retrieval_successful": true,
        "chunk_details": [
          {
            "chunk_id": "e558f11e",
            "similarity": NaN,
            "content_preview": "MEDICARE SUPPLEMENTAL INSURANCE POLICY\nPolicy Number: MS-12345\nEffective Date: 2025-01-01"
          },
          {
            "chunk_id": "4abd73d7",
            "similarity": NaN,
            "content_preview": "COVERAGE DETAILS:\n- Deductible: $240 per year\n- Coinsurance: 20% after deductible\n- Out-of-pocket ma..."
          },
          {
            "chunk_id": "2855900b",
            "similarity": NaN,
            "content_preview": "PREVENTIVE SERVICES:\n- Annual wellness visit: $0\n- Flu shots: $0\n- Mammograms: $0\n- Colonoscopy: $0"
          }
        ]
      }
    },
    "end_to_end_information_request": {
      "status": "FAIL",
      "details": {
        "total_queries": 5,
        "successful_queries": 0,
        "overall_success": false,
        "query_results": [
          {
            "query": "What is my deductible?",
            "status": "FAIL",
            "error": "HTTP 500",
            "response_preview": "Request failed"
          },
          {
            "query": "How much do I pay for specialist visits?",
            "status": "FAIL",
            "error": "HTTP 500",
            "response_preview": "Request failed"
          },
          {
            "query": "What preventive services are covered?",
            "status": "FAIL",
            "error": "HTTP 500",
            "response_preview": "Request failed"
          },
          {
            "query": "What is my out-of-pocket maximum?",
            "status": "FAIL",
            "error": "HTTP 500",
            "response_preview": "Request failed"
          },
          {
            "query": "Are emergency room visits covered?",
            "status": "FAIL",
            "error": "HTTP 500",
            "response_preview": "Request failed"
          }
        ]
      }
    },
    "database_consistency": {
      "status": "PASS",
      "details": {
        "user_documents_count": 1,
        "user_chunks_count": 3,
        "documents_valid": true,
        "chunks_valid": true,
        "uuid_consistency": true,
        "user_documents": [
          {
            "document_id": "88177a84-5636-5774-b0c0-4d6f2879af30",
            "user_id": "250825d8-eba5-4cbd-8084-e2ebf867e7df",
            "filename": "test_insurance_policy_1757943706.pdf",
            "processing_status": "processed",
            "created_at": "2025-09-15 13:41:47.272603+00:00"
          }
        ],
        "user_chunks": [
          {
            "chunk_id": "2855900b-71a3-56a1-b1d3-6baf7b015c32",
            "document_id": "88177a84-5636-5774-b0c0-4d6f2879af30",
            "content": "PREVENTIVE SERVICES:\n- Annual wellness visit: $0\n- Flu shots: $0\n- Mammograms: $0\n- Colonoscopy: $0",
            "chunk_index": 2,
            "created_at": "2025-09-15 13:41:47.442777+00:00"
          },
          {
            "chunk_id": "4abd73d7-2514-5d89-a6ff-cbea0420df83",
            "document_id": "88177a84-5636-5774-b0c0-4d6f2879af30",
            "content": "COVERAGE DETAILS:\n- Deductible: $240 per year\n- Coinsurance: 20% after deductible\n- Out-of-pocket maximum: $2,000 per year",
            "chunk_index": 1,
            "created_at": "2025-09-15 13:41:47.429538+00:00"
          },
          {
            "chunk_id": "e558f11e-18d5-593c-b210-f079d0d1f657",
            "document_id": "88177a84-5636-5774-b0c0-4d6f2879af30",
            "content": "MEDICARE SUPPLEMENTAL INSURANCE POLICY\nPolicy Number: MS-12345\nEffective Date: 2025-01-01",
            "chunk_index": 0,
            "created_at": "2025-09-15 13:41:47.399404+00:00"
          }
        ]
      }
    }
  },
  "summary": {
    "total_tests": 7,
    "passed": 6,
    "failed": 1,
    "critical_failures": 1
  },
  "workflow": {
    "user_created": true,
    "user_id": "250825d8-eba5-4cbd-8084-e2ebf867e7df",
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiMjJkZTZlZS1mNjA4LTRlMDgtYTliNS1jOWUxZWYyNDdiOTQiLCJlbWFpbCI6InVwbG9hZF9yYWdfdGVzdF8xNzU3OTQzNzA2QGV4YW1wbGUuY29tIiwiZXhwIjoxNzU4MDMwMTA2LCJpYXQiOjE3NTc5NDM3MDYsImlzcyI6Imluc3VyYW5jZS1uYXZpZ2F0b3ItbWluaW1hbC1hdXRoIiwiYXVkIjoiaW5zdXJhbmNlLW5hdmlnYXRvci11c2VycyJ9.BfB_39hhV8SUAlVeGpU1FUzMG8g3j7Ju1jVyEUbIoZ0",
    "document_uploaded": true,
    "document_id": "88177a84-5636-5774-b0c0-4d6f2879af30",
    "document_processed": true,
    "rag_query_tested": true,
    "rag_response_received": false,
    "conversation_id": null
  }
}